fileVersion: 1
id: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
name: WRK_PRECIPTIME_SNOWTIME_RAINTIME
operation:
  config:
    asofColumn:
      items:
        - {}
    asofJoin: true
    asofJoinMain: true
    asofJoinON: false
    asofJoinUSING: false
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    groupByAll: false
    insertStrategy: INSERT
    orderby: false
    orderbycolumn:
      items:
        - {}
    postSQL: ""
    preSQL: ""
    selectDistinct: false
    testsEnabled: false
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34a4bb62-3741-457e-acbd-c8bd6e3c598b
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: TIME(9)
        description: ""
        name: OBSERVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea5da0a0-99fa-4e1d-bb5b-86ee85fa0c3e
                stepCounter: baa4aac0-e2a2-4359-8e59-e795f844929f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 620f979c-56aa-44e2-8998-a7546af23be3
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 483399d6-b883-4971-ab5e-cd8884d97901
                stepCounter: baa4aac0-e2a2-4359-8e59-e795f844929f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e89e7294-9707-4591-b588-bfcdc52a711a
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6322909-5fab-4f48-92dd-31066ac2854e
                stepCounter: baa4aac0-e2a2-4359-8e59-e795f844929f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00b0d5af-1c4b-4548-99b9-3aff3022882c
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: NUMBER(5,2)
        description: ""
        name: OBSERVATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d048e7b8-dd41-4db0-b595-11908d3f0cb5
                stepCounter: baa4aac0-e2a2-4359-8e59-e795f844929f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 216414e5-34da-4dc1-8f82-75283c118705
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: TIME(9)
        description: ""
        name: S_OBSERVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43c5e7af-2708-4081-b730-95eeff4aa101
                stepCounter: 3d52ba4e-9a03-4b59-86b9-fd95c2497250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1045375-89b0-4a8b-957b-bcf1c84d5716
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: S_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e84cce3-eaee-4f92-95d0-82b3296fba2d
                stepCounter: 3d52ba4e-9a03-4b59-86b9-fd95c2497250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d207f807-bdfc-45ac-af4c-d993aef5110e
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: S_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce1acd3c-1d71-4c89-8240-8ca3aded6e8a
                stepCounter: 3d52ba4e-9a03-4b59-86b9-fd95c2497250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a17f6f9-ebd2-4b94-b331-0a0dbaa8ab96
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: NUMBER(5,2)
        description: ""
        name: S_OBSERVATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e3abc29-a579-42f9-8352-2e1a79c7c50c
                stepCounter: 3d52ba4e-9a03-4b59-86b9-fd95c2497250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6949f655-a67f-4162-bae8-d817fdaedc82
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: TIME(9)
        description: ""
        name: R_OBSERVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef99b706-8e36-48b9-870a-a45d95d5bec3
                stepCounter: 3c82ef16-f296-49ba-921e-12d865c6aecc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e792bcac-dc57-47be-92fc-d0e7a686fa56
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: R_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c432988f-82b2-4bb3-b9f0-0fe36fce1b5f
                stepCounter: 3c82ef16-f296-49ba-921e-12d865c6aecc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0b21b0a-fa1a-4868-b310-d966068bb2bb
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: R_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48164065-702a-4cf0-9e48-e7a293b2925c
                stepCounter: 3c82ef16-f296-49ba-921e-12d865c6aecc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab591769-6027-4bce-855e-1caa3e87534c
          stepCounter: 8afea8e1-2a35-4c85-ba59-c004f8b59b82
        config: {}
        dataType: NUMBER(5,2)
        description: ""
        name: R_OBSERVATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bd75f27-537d-44a0-89c2-6c0faffbcb9f
                stepCounter: 3c82ef16-f296-49ba-921e-12d865c6aecc
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_PRECIPTIME: baa4aac0-e2a2-4359-8e59-e795f844929f
          STG_RAINTIME: 3c82ef16-f296-49ba-921e-12d865c6aecc
          STG_SNOWTIME: 3d52ba4e-9a03-4b59-86b9-fd95c2497250
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: STG_PRECIPTIME
          - locationName: WORK
            nodeName: STG_RAINTIME
          - locationName: WORK
            nodeName: STG_SNOWTIME
        join:
          joinCondition: |-
            
               FROM  {{ ref('WORK', 'STG_SNOWTIME') }} "STG_SNOWTIME"
               ASOF JOIN {{ ref('WORK', 'STG_RAINTIME') }} "STG_RAINTIME"
               MATCH_CONDITION ("STG_SNOWTIME"."S_OBSERVED" >="STG_RAINTIME"."R_OBSERVED" ) 
               ON  ("STG_SNOWTIME"."S_STATE" = "STG_RAINTIME"."R_STATE" )
               ASOF JOIN {{ ref('WORK', 'STG_PRECIPTIME') }} "STG_PRECIPTIME"
               MATCH_CONDITION ("STG_SNOWTIME"."S_OBSERVED" >= "STG_PRECIPTIME"."OBSERVED" ) 
               ON  ("STG_SNOWTIME"."S_STATE" = "STG_PRECIPTIME"."STATE" )
        name: WRK_PRECIPTIME_SNOWTIME_RAINTIME
        noLinkRefs: []
  name: WRK_PRECIPTIME_SNOWTIME_RAINTIME
  overrideSQL: false
  schema: ""
  sqlType: "27"
  type: sql
  version: 1
type: Node
