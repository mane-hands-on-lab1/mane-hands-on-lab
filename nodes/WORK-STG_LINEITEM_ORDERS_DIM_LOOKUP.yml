fileVersion: 1
id: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
name: STG_LINEITEM_ORDERS_DIM_LOOKUP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2f95227-b78e-4654-8971-07e56873dc1e
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 286935e9-f790-48f8-affc-32712246d976
                stepCounter: a9114697-d6ea-4a0b-813a-f3d638d6776e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23030627-b555-48ea-a361-0b41f3276ef0
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a5fe9b-7400-4b80-930e-ba38935c89c8
                stepCounter: a9114697-d6ea-4a0b-813a-f3d638d6776e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46ea6195-1a02-4cdf-8399-e7b7cafee6aa
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a174e47a-00ba-48c9-9490-ca6f57551d7d
                stepCounter: e5c4169a-c2dd-46ca-87e6-aef7aba48cd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f60f0298-b68c-453d-8ccd-c63bd3b7ccfd
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_PART_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87af8e6-7f32-4722-8d7a-6a1055969c67
                stepCounter: 5cfaaa37-ebc9-4920-b8f8-aed1556352fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 592b35f9-c6fc-4e71-b3cc-923f9c328fee
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b73ffed-7bd8-4501-9016-7821acc4b3cf
                stepCounter: 6814f6ca-493a-49f8-b0a5-80f25ea64467
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8651b715-9387-49b3-bc4f-d00f7570c022
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3724a083-76f0-4722-8167-11b174c094e0
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e527c69f-57a4-4bf6-84ce-2b201730881f
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdb628b8-4e9d-40fe-bc12-67ab98d81741
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45e34d3f-104c-4f8f-92ff-c66e51b02622
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6928489-5c8c-4de2-9f65-065082a5300c
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da711991-d6a0-41cb-93a5-105fea50f654
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 797d9337-a849-44a5-9813-4628aec22b08
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03841745-41c5-4295-9202-f7712093c5f0
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46b8fb7e-1179-4f06-af2a-deec22942db0
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a99482be-5095-426f-9287-fa5a59ca3dce
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71cd5c5d-5db5-4323-a04b-dafd6151a05b
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b4d26a7-50d1-4ce5-bf12-2fab4a7edf39
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86554ae1-4a36-4a1d-bbb8-acd11d0730b0
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b500528-4abc-4205-b0f4-2fbada5090bf
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30e8b233-aa38-478c-8fe0-4f388928465f
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f656650-1db7-4549-ae97-382ace764929
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e367c61-4335-424d-805d-760c9b55e391
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a8fd8f1-71f4-48fd-9eaa-3595e0b02ba2
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bf08f68-21fc-497d-8219-42be837504fa
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f713c75e-b935-4f28-a478-9b0e31d36c40
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 214292cd-de5f-402b-a7fa-f7adde297b25
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcb3a2e0-b078-44ee-82cc-6b3a0dbfba02
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47519176-50ec-4cfd-a085-ae9ea8a1f37b
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c34b1b-fc82-460c-bd7a-2447ea113033
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 396c5698-9a57-439a-bf64-d37a05c2845a
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b826b879-91d2-4a97-b1d8-a519f3da8613
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea20faeb-3d0c-4438-962c-796b0a49d002
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f715fe01-7083-4f9b-b96e-6493409e3d68
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70ae93e8-2252-4d9b-b112-b08d3ca9f0c5
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89ac757c-a05b-4ded-bfc4-173c3f75683b
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74f1657d-b63f-4564-b2cd-0514160fe38c
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f4b8ea5-097e-4aec-ba6d-d5daca25a2ca
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d469ff5-bdae-47c7-b716-22197bdb17f8
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2192147-ace4-4217-81b1-198dbc7344bc
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07717e10-02c9-4417-9728-d500c14a3164
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c87442cb-610e-4e3c-8c44-e21ef2eddd10
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1108c837-cda7-44fe-9ec0-9a41488c9003
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5968ba90-d45b-4ccd-bc94-58fc1385d20f
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19931d18-8bc1-454d-9e57-c99f9f240b11
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f42c8120-8573-4fa2-b930-12ef9ae58ee8
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10e85765-6eb6-4f0a-a722-b990b46f6850
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a6069d8-35ba-45b3-8e6c-4d22a72db8bf
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b17aaec1-7f78-4737-9abd-9c8ba6b2d42e
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3f0fb0d-d414-4381-a91c-aa8e4a2e5084
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caaac3a0-8b8d-4aa2-8ef6-8cf19f0b53c4
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7bdcf17-c58a-4876-9743-9eb766833ff7
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c78d687-95ce-4522-b0d0-b639617d2f4a
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac879aea-c3fb-4838-9feb-d2aa9480c199
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc25b84e-bb64-47fd-ba50-a1ca63613cbf
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aedab3f0-b2cc-448e-a649-9d676eed65e0
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c90dde86-671c-45e9-9949-c36809fd0e03
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bccb107e-e635-4e25-8a02-a81b885bb1f0
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER
        description: ""
        name: DAYS TO SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 120e2e93-b647-4dde-aa6e-c149ccff1ef4
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ad1bd3a3-4a7b-48df-8949-42cdb06893a2
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY1
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a57e3121-db22-488a-9ece-18b1b00b12e8
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 874a8992-71d5-4864-933a-4d20dd0c45c9
          stepCounter: 601faa4e-965f-402a-a22c-f0ccd85aa3b4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST1
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3881744-9730-4864-92b9-8aebdd4a0f5b
                stepCounter: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_CUSTOMER: e5c4169a-c2dd-46ca-87e6-aef7aba48cd6
          DIM_PART: 5cfaaa37-ebc9-4920-b8f8-aed1556352fa
          DIM_SUPPLIER: 6814f6ca-493a-49f8-b0a5-80f25ea64467
          STG_LINEITEM_ORDERS: 08bebdd8-5d97-44d4-8c8d-b98ded9967ba
          STG_PARTSUPP: a9114697-d6ea-4a0b-813a-f3d638d6776e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: DIM_CUSTOMER
          - locationName: WORK
            nodeName: DIM_PART
          - locationName: WORK
            nodeName: DIM_SUPPLIER
          - locationName: WORK
            nodeName: STG_LINEITEM_ORDERS
          - locationName: WORK
            nodeName: STG_PARTSUPP
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
            
            LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
            
            ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
            
            AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
            
            /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
            
            LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
            
            ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
            
            LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
            
            ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
            
            LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
            
            ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
            
            "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
        name: STG_LINEITEM_ORDERS_DIM_LOOKUP
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS_DIM_LOOKUP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
